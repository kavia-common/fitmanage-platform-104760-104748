{"is_source_file": true, "format": "Python", "description": "This file defines API routes for managing user-specific settings within a FastAPI application. It includes data models for preferences, database models for persistent storage, and route handlers for retrieving and updating user settings, utilizing dependencies such as database sessions and user authentication.", "external_files": ["src.core.database", "src.core.security", "src.models"], "external_methods": ["get_db", "get_current_user"], "published": ["router"], "classes": [{"name": "Preferences", "description": "Data model representing user preferences, including theme, notifications, and locale."}, {"name": "SettingsRead", "description": "Response model for returning user settings."}, {"name": "SettingsUpdate", "description": "Model for updating user preferences."}, {"name": "UserSettings", "description": "SQLAlchemy ORM model for the user settings table."}], "methods": [{"name": "UserSettings _get_or_create_user_settings(db: Session, user_id: int)", "description": "Retrieves the UserSettings record for a given user or creates it if not existing.", "scope": "", "scopeKind": ""}, {"name": "get_my_settings( db: Session = Depends(get_db), current: User = Depends(get_current_user), )", "description": "API endpoint to get the current user's settings.", "scope": "", "scopeKind": ""}, {"name": "update_my_settings( payload: SettingsUpdate, db: Session = Depends(get_db), current: User = Depends(get_current_user), )", "description": "API endpoint to update the current user's preferences.", "scope": "", "scopeKind": ""}], "calls": ["get_db", "get_current_user", "db.query", "db.add", "db.commit", "db.refresh"], "search-terms": ["Preferences", "UserSettings", "settings", "router", "FastAPI"], "state": 2, "file_id": 54, "knowledge_revision": 152, "git_revision": "", "revision_history": [{"149": ""}, {"152": ""}], "ctags": [{"_type": "tag", "name": "Preferences", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^class Preferences(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SettingsRead", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^class SettingsRead(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "SettingsUpdate", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^class SettingsUpdate(BaseModel):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "UserSettings", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^class UserSettings(Base):$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__table_args__", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^    __table_args__ = (UniqueConstraint(\"user_id\", name=\"uq_user_settings_user\"),)$/", "file": true, "language": "Python", "kind": "variable", "scope": "UserSettings", "scopeKind": "class"}, {"_type": "tag", "name": "__tablename__", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^    __tablename__ = \"user_settings\"$/", "file": true, "language": "Python", "kind": "variable", "scope": "UserSettings", "scopeKind": "class"}, {"_type": "tag", "name": "_get_or_create_user_settings", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^def _get_or_create_user_settings(db: Session, user_id: int) -> UserSettings:$/", "language": "Python", "typeref": "typename:UserSettings", "kind": "function", "signature": "(db: Session, user_id: int)"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^    data = Column(JSON, nullable=False, default={})$/", "language": "Python", "kind": "variable", "scope": "UserSettings", "scopeKind": "class"}, {"_type": "tag", "name": "get_my_settings", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^def get_my_settings($/", "language": "Python", "kind": "function", "signature": "( db: Session = Depends(get_db), current: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^    id = Column(Integer, primary_key=True)$/", "language": "Python", "kind": "variable", "scope": "UserSettings", "scopeKind": "class"}, {"_type": "tag", "name": "locale", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^    locale: Optional[str] = Field(default=None, description=\"Preferred locale\\/language code\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Preferences", "scopeKind": "class"}, {"_type": "tag", "name": "notifications_enabled", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^    notifications_enabled: bool = Field(default=True, description=\"Enable in-app notifications\")$/", "language": "Python", "typeref": "typename:bool", "kind": "variable", "scope": "Preferences", "scopeKind": "class"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^router = APIRouter()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "theme", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^    theme: Optional[str] = Field(default=\"light\", description=\"UI theme, e.g., light\\/dark\")$/", "language": "Python", "typeref": "typename:Optional[str]", "kind": "variable", "scope": "Preferences", "scopeKind": "class"}, {"_type": "tag", "name": "update_my_settings", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^def update_my_settings($/", "language": "Python", "kind": "function", "signature": "( payload: SettingsUpdate, db: Session = Depends(get_db), current: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "user_id", "path": "/home/kavia/workspace/code-generation/fitmanage-platform-104760-104748/fitness_nutrition_backend/src/settings/router.py", "pattern": "/^    user_id = Column(Integer, ForeignKey(\"users.id\", ondelete=\"CASCADE\"), nullable=False, index=/", "language": "Python", "kind": "variable", "scope": "UserSettings", "scopeKind": "class"}], "hash": "b65424c8f6fad2667ef97bef2b295146", "format-version": 4, "code-base-name": "fitness_nutrition_backend", "filename": "fitness_nutrition_backend/src/settings/router.py", "fields": [{"name": "__table_args__ = (UniqueConstraint(\"user_id\", name=\"uq_user_settings_user\"),)", "scope": "UserSettings", "scopeKind": "class", "description": "unavailable"}, {"name": "__tablename__ = \"user_settings\"", "scope": "UserSettings", "scopeKind": "class", "description": "unavailable"}, {"name": "data = Column(JSON, nullable=False, default={})", "scope": "UserSettings", "scopeKind": "class", "description": "unavailable"}, {"name": "id = Column(Integer, primary_key=True)", "scope": "UserSettings", "scopeKind": "class", "description": "unavailable"}, {"name": "Optional[str] locale", "scope": "Preferences", "scopeKind": "class", "description": "unavailable"}, {"name": "bool notifications_enabled", "scope": "Preferences", "scopeKind": "class", "description": "unavailable"}, {"name": "router = APIRouter()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[str] theme", "scope": "Preferences", "scopeKind": "class", "description": "unavailable"}, {"name": "user_id = Column(Integer, ForeignKey(\"users.id\", ondelete=\"CASCADE\"), nullable=False, index=/", "scope": "UserSettings", "scopeKind": "class", "description": "unavailable"}]}